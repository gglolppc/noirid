{% extends "base.html" %}
{% block title %}Order {{ order_id }} Â· NOIRID{% endblock %}

{% block content %}
<div class="relative bg-[#050505] selection:bg-white selection:text-black">
  <section class="min-h-screen pt-32 pb-24 px-6 md:px-12">
    <div class="mx-auto max-w-6xl w-full">

      <div class="reveal flex flex-col md:flex-row md:items-end md:justify-between gap-8">
        <div>
          <div class="text-[10px] uppercase tracking-[0.5em] text-zinc-500 font-medium">Order / Status</div>
          <h1 class="mt-6 text-6xl md:text-8xl font-bold uppercase tracking-[-0.05em] text-white leading-[0.85]">
            Track Order
          </h1>
          <p class="mt-6 text-sm text-zinc-400 font-light italic">Ref: <span class="text-white">{{ order_id }}</span></p>
        </div>
        <a href="/catalog" class="text-[10px] uppercase tracking-[0.3em] text-zinc-500 hover:text-white transition">
          Return to Catalog
        </a>
      </div>

      <div class="mt-12 h-px w-full bg-gradient-to-r from-white/20 via-white/5 to-transparent"></div>

      {% if not order %}
        <div class="reveal reveal-delay-1 mt-16 py-24 rounded-[40px] border border-dashed border-white/10 bg-white/[0.02] text-center">
          <h3 class="text-2xl font-light text-white mb-8">Order ID not found.</h3>
          <a href="/check-order" class="inline-block border border-white/20 px-10 py-4 text-[10px] uppercase tracking-[0.3em] text-white hover:bg-white hover:text-black transition-all">
            Try Another ID
          </a>
        </div>
      {% else %}
        <div class="mt-16 grid grid-cols-1 lg:grid-cols-2 gap-12 lg:gap-24">

          <div class="reveal reveal-delay-1 space-y-12">

            <section class="rounded-[32px] border border-white/10 bg-white/[0.03] p-10">
              <div class="text-[10px] uppercase tracking-[0.3em] text-zinc-500 mb-8 border-b border-white/5 pb-4">
                Current State
              </div>

              <div class="space-y-10">
                <div>
                  <div class="text-[10px] uppercase tracking-[0.2em] text-zinc-600 mb-2">Payment Status</div>
                  <div id="payStatus" class="text-4xl font-bold text-white uppercase tracking-tight">
                    {{ order.payment_status if order.payment_status else 'UNPAID' }}
                  </div>
                </div>

                <div>
                  <div class="text-[10px] uppercase tracking-[0.2em] text-zinc-600 mb-2">Fulfillment</div>
                  <div id="orderStatus" class="text-2xl font-medium text-white/90 italic">
                    {{ order.status }}
                  </div>
                </div>

                <div id="hint" class="flex items-center gap-3 text-[10px] uppercase tracking-[0.1em] text-zinc-500">
                  <span class="w-2 h-2 rounded-full bg-zinc-800 animate-pulse"></span>
                  Status updates automatically via webhooks
                </div>
              </div>

              <div class="mt-12 flex flex-wrap gap-4">
                <button id="refreshBtn"
                        class="px-8 py-3 rounded-full border border-white/15 text-[10px] uppercase tracking-[0.3em] font-bold text-white hover:bg-white hover:text-black transition-all">
                  Refresh
                </button>
                <a id="retryPayBtn"
                   href="/checkout"
                   class="hidden px-8 py-3 rounded-full bg-white text-black text-[10px] font-bold uppercase tracking-[0.3em] transition-transform hover:scale-[1.02]">
                  Try Payment Again
                </a>
              </div>
            </section>

          </div>

          <div class="reveal reveal-delay-2">
            <div class="lg:pl-12 space-y-12">
              <section>
                <h2 class="text-[10px] uppercase tracking-[0.4em] text-zinc-500 mb-8 flex items-center gap-4">
                  Customer Details <span class="h-px flex-1 bg-white/5"></span>
                </h2>

                <div class="space-y-6">
                  <div>
                    <div class="text-[10px] uppercase tracking-[0.2em] text-zinc-500">Identifier</div>
                    <div class="text-white font-medium mt-1">{{ order.customer_name or '-' }}</div>
                  </div>
                  <div>
                    <div class="text-[10px] uppercase tracking-[0.2em] text-zinc-500">Contact</div>
                    <div class="text-white font-medium mt-1 underline underline-offset-4 decoration-white/10">{{ order.customer_email or '-' }}</div>
                  </div>
                </div>
              </section>

              <section>
                <h2 class="text-[10px] uppercase tracking-[0.4em] text-zinc-500 mb-8 flex items-center gap-4">
                  Destination <span class="h-px flex-1 bg-white/5"></span>
                </h2>

                <div class="grid grid-cols-2 gap-8">
                  <div>
                    <div class="text-[10px] uppercase tracking-[0.2em] text-zinc-500">Country</div>
                    <div class="text-white font-medium mt-1">{{ (order.shipping_address or {}).get('country','-') }}</div>
                  </div>
                  <div>
                    <div class="text-[10px] uppercase tracking-[0.2em] text-zinc-500">City</div>
                    <div class="text-white font-medium mt-1">{{ (order.shipping_address or {}).get('city','-') }}</div>
                  </div>
                </div>
              </section>
            </div>
          </div>

        </div>

        <script>
          const ORDER_ID = "{{ order.id }}";
        </script>
        <script src="/static/js/public/order_status.js"></script>
      {% endif %}
    </div>
  </section>
</div>
{% endblock %}